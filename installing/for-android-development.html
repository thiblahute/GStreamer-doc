<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Installing for Android development</title>

<link rel="stylesheet" href="assets/css/custom_bootstrap.css" type="text/css">
<link rel="stylesheet" href="assets/css/frontend.css" type="text/css">
<link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.min.css">

<link rel="stylesheet" href="assets/css/prism.css" type="text/css">

<script src="assets/js/mustache.min.js"></script>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/typeahead.jquery.min.js"></script>
<script src="assets/js/search.js"></script>
<script src="assets/js/isotope.pkgd.min.js"></script>
<script src="assets/js/compare-versions.js"></script>
<script src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="assets/js/utils.js"></script>
<script src="assets/js/tag_filtering.js"></script>
<script src="assets/js/language_switching.js"></script>
<script src="assets/js/navigation.js"></script>


<script src="assets/js/lines_around_headings.js"></script>

<script src="assets/js/prism-core.js"></script>
<script src="assets/js/prism-autoloader.js"></script>
<script src="assets/js/prism_autoloader_path_override.js"></script>
<script src="assets/js/trie.js"></script>


<link rel="icon" type="image/png" href="assets/images/favicon.png">
<link rel="shortcut icon" href="assets/images/favicon.png">

</head>

<body data-spy="scroll" data-target=".scrollspy" data-offset="70">


<nav class="navbar navbar-fixed-top navbar-default">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-wrapper" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a href="https://gstreamer.freedesktop.org/" class="hotdoc-navbar-brand">
				<img src="assets/images/gstreamer-logo.svg" alt="Home" id="home">
			</a>
		</div>
		<div class="navbar-collapse collapse" id="navbar-wrapper">
			<ul class="nav navbar-nav" id="menu">
							</ul>
		</div>
	</div>
</nav>

<main class="page-row page-row-expanded">
<div data-extension="core" data-hotdoc-project="" data-hotdoc-ref="installing/for-android-development.html" class="page_container" id="page-wrapper">
	<div class="row">
		<div class="hidden-xs hidden-sm col-md-3 col-xl-2" id="sidenav-column">
	<div class="panel panel-collapse" id="sidenav" data-hotdoc-role="navigation">
		<div id="sidenav-search" role="search">
			<input type="text" class="form-control" placeholder="Fetching index" id="sidenav-lookup-field" disabled>
		</div>
		<div id="sitenav-wrapper" class="mCustomScrollbar" data-mcs-theme="minimal">
			<div class="sidenav-main-panel-body">
				<div id="site-navigation">
				</div>
			</div>
			<!-- FIXME -->
			<div style="height: 76px;"></div>
		</div>
	</div>
</div>

<div class="col-sm-12 col-md-9 col-xl-8">
	<div id="main">
				
<div id="page-description" data-hotdoc-source="for-android-development.md">
<h1 id="installing-for-android-development">Installing for Android development</h1>
<p><img src="images/icons/emoticons/information.png" alt="information" id="information"> All versions starting from 2.3.1 Gingerbread are supported</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>The development machine is where you will develop your Android
application, which then you will deploy on the target machine, which
should obviously be an Android device.</p>
<p>The development machine can either be a Linux, Mac OS X or Windows, and
needs to have installed:</p>
<ul>
<li>The latest version of the <a href="http://developer.android.com/sdk/index.html">Android SDK</a></li>
<li>The latest version of the <a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a></li>
<li>GStreamer for Android is targeted at API version 9 (Android
2.3.1, Gingerbread) or higher. Use the SDK Manager tool to make sure
you have at least one Android SDK platform installed with API
version 9 or higher.</li>
</ul>
<!-- Optionally, you can use the [Android Studio](https://developer.android.com/studio/index.html). As stated in
the Android documentation, *developing in Android Studio is highly
recommended and is the fastest way to get started*. -->
<p>Before continuing, make sure you can compile and run the samples
included in the Android NDK, and that you understand how the integration
of C and Java works via the <a href="http://en.wikipedia.org/wiki/Java_Native_Interface">Java Native Interface</a> (JNI). Besides the
<a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a> documentation, you can find some useful <a href="http://developer.android.com/guide/practices/jni.html">Android JNI tips
here</a>.</p>
<h2 id="download-and-install-gstreamer-binaries">Download and install GStreamer binaries</h2>
<p>The GStreamer project provides <a href="https://gstreamer.freedesktop.org/data/pkg/android/">prebuilt binaries</a> you should download
the latest version and unzip it into any folder of your choice.</p>
<p>In the process of building GStreamer-enabled Android applications,
some tools will need to know where you installed the GStreamer
binaries. You must define an environment variable called
<code>GSTREAMER_ROOT_ANDROID</code> and point it to the folder where you
extracted the GStreamer binaries. This environment variable must be available at
build time, so maybe you want to make it available system-wide by
adding it to your <code>~/.profile</code> file (on Linux and Mac) or to the
Environment Variables in the System Properties dialog (on Windows).</p>
<p>Point <code>GSTREAMER_ROOT_ANDROID</code> to the folder where you unzipped the binaries.</p>
<blockquote>
<p><img src="images/icons/emoticons/information.png" alt="information" id="information1"> If you plan to use Android Studio and do not want to define this
environment variable globally, you can set it inside the build.gradle.</p>
</blockquote>
<blockquote>
<p><img src="images/icons/emoticons/information.png" alt="information" id="information2"> If you plan to use Eclipse, and do not want to define this
environment variable globally, you can set it inside Eclipse. Go to
Window → Preferences → C/C++ → Build → Build Variables and define
<code>GSTREAMER_ROOT_ANDROID</code> there.</p>
</blockquote>
<blockquote>
<p><img src="images/icons/emoticons/warning.png" alt="warning" id="warning"> The NDK support in the Gradle build system used by
Android Studio is still in beta, so the recommended way to build
using the GStreamer SDK is still to use "ndk-build".</p>
</blockquote>
<h2 id="configure-your-development-environment">Configure your development environment</h2>
<p>There are two routes to use GStreamer in an Android application: Either
writing your GStreamer code in Java or in C.</p>
<p>Android applications are mainly written in Java, so adding GStreamer
code to them in the same language is a huge advantage. However, this
requires using <a href="http://en.wikipedia.org/wiki/Language_binding">language bindings</a> for the GStreamer API which are not
complete yet. In the meantime, this documentation will use Java for the
User Interface (UI) part and C for the GStreamer code. Both parts
interact through <a href="http://en.wikipedia.org/wiki/Java_Native_Interface">JNI</a>.</p>
<h3 id="building-the-tutorials">Building the tutorials</h3>
<p>The tutorials code are in the
<a href="https://cgit.freedesktop.org/gstreamer/gst-docs/">gst-docs</a> in the
<code>examples/tutorials/</code> folder.</p>
<p>There are a few Android-specific tutorials in the <code>tutorials/</code>
folder. Each tutorial is a folder containing source code (in Java and
C) and the resource files required to build a complete Android
application.</p>
<p>The rest of the GStreamer tutorials (basic and playback tutorials)
cannot be run on Android without modification.</p>
<p>Android projects with GStreamer support are built like conventional
Android NDK projects, so the instructions at the <a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a> home can
be followed:</p>
<!--
#### Using Android Studio

> ![warning] To be completed!!
-->
<h4 id="using-eclipse">Using Eclipse</h4>
<p>Make sure you have installed the ADT and NDK plugins listed in the
prerequisites section, and that they are both aware of the location of
the Android SDK and NDK respectively.</p>
<p>Import a tutorial into the Eclipse workspace:
File → New → Project… → Android Project from Existing Code, and select
the folder called <code>android-tutorial-1</code>.</p>
<p>After reading in the project and generating some extra files and
folders, Eclipse might complain about missing files. <strong>This is normal</strong>,
we are not finished yet.</p>
<p>Provide native development support by activating the NDK plugin:
Right-click on the project in the Project Explorer (this should be the
top-most folder,
called <code>com.gst_sdk_tutorials.tutorial_1.Tutorial1</code>) → Android
tools → Add Native Support… Here the NDK plugin asks for a library name.
This is irrelevant and any valid file name will do. Accept.</p>
<p>Eclipse will still complain about errors in the code. <strong>This is
normal</strong>. Some files are missing because they are generated during the
first build run.</p>
<p>Build the project: Project → Build Project. If you bring up the Eclipse
Console, you should see some progress messages. Once finished, the
missing files will appear and all error messages should be gone. The
project is now ready to run. Hit Run → Run.</p>
<p>A new application called “Android tutorial 1” should now be available on
your device, with the GStreamer logo. If you want to run the
tutorial in an Android Virtual Device (AVD), make sure to create the
device with support for audio playback and GPU Emulation (to enable
OpenGL ES).</p>
<h4 id="using-the-command-line">Using the command line</h4>
<blockquote>
<p><img src="images/icons/emoticons/warning.png" alt="warning" id="warning1"> Note that, on Windows, this procedure requires a working Cygwin
shell, as explained in the <a href="http://developer.android.com/tools/sdk/ndk/index.html#Reqs">Android NDK System Requirements</a></p>
</blockquote>
<p>For each tutorial, move to its folder and run:</p>
<pre><code>android update project -p . -s --target X
</code></pre>
<p>Where <code>X</code> is one of the targets available in your system (the ones you
installed with the SDK manager). Make sure to use a target with at least
API level 9.</p>
<p>To get a list of all available targets in your system issue this
command:</p>
<pre><code>android list
</code></pre>
<p>The “update project” command generates the <code>build.xml</code> file needed by
the build system. You only need to perform this action once per project.</p>
<p>To build the C part, just call:</p>
<pre><code>ndk-build
</code></pre>
<p>A few lines in the <code>Android.mk</code> file (reviewed later) pull up the
necessary machinery to compile the GStreamer bits and generate the
Shared Object libraries (.so) that the Java code can use as native
methods.</p>
<p>Finally, compile the Java code with:</p>
<pre><code>ant debug
</code></pre>
<p>And install on the device with:</p>
<pre><code>adb install -r bin/Tutorial1-debug.apk
</code></pre>
<p>The <code>-r</code> switch allows the installer to overwrite previous versions.
Otherwise, you need to manually uninstall previous versions of your
application.</p>
<p>A new application called “Android tutorial 1” should now be available on
your device, with the GStreamer logo. If you want to run the
tutorial in an Android Virtual Device (AVD), make sure to create the
device with support for audio playback and GPU Emulation (to enable
OpenGL ES).</p>
<blockquote>
<p><img src="images/icons/emoticons/warning.png" alt="warning" id="warning2"> Windows linkage problems</p>
<p>Due to problems related to the standard linker, Google’s
<a href="http://en.wikipedia.org/wiki/Gold_(linker)" class="external-link">Gold
Linker</a> is used to build GStreamer applications.  Unfortunately,
the Android NDK toolchain for Windows does not include the gold linker
and the standard one has to be used.</p>
<p>If you observe linkage problems, you can replace the linker in your
Android NDK with the gold one from <a href="http://code.google.com/p/mingw-and-ndk/downloads/detail?name=android-ndk-r8b-ma-windows.7z&amp;can=2&amp;q=">this project</a>. Download the
<code>android-ndk-r8b-ma-windows.7z</code> file, extract
<code>\android-ndk-r8b\toolchains\arm-linux-androideabi-4.6\prebuilt\windows\arm-linux-androideabi\bin\ld.exe</code>
(only this file is needed) and overwrite the one in the same folder in
your Android NDK installation. You might need the free <a href="http://www.7-zip.org/">7-Zip
archiving utility</a></p>
</blockquote>
<h3 id="creating-new-projects">Creating new projects</h3>
<p>Create a normal NDK project, either from the command line as described
in the <a href="http://developer.android.com/tools/sdk/ndk/index.html#GetStarted">Android NDK</a> home, or use Eclipse: File → New → Project…
→ Android Application Project, and, once the wizard is complete, right
click on the project → Android Tools → Add Native Support …</p>
<p>To add GStreamer support you only need to modify the
<code>jni/Android.mk</code> file. This file describes the native files in your
project, and its barebones structure (as auto-generated by Eclipse) is:</p>
<p><strong>Android.mk</strong></p>
<pre><code>LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := NativeApplication
LOCAL_SRC_FILES := NativeApplication.c

include $(BUILD_SHARED_LIBRARY)
</code></pre>
<p>Where line 5 specifies the name of the <code>.so</code> file that will contain your
native code and line 6 states all source files that compose your native
code, separated by spaces.</p>
<p>Adding GStreamer support only requires adding these lines:</p>
<p><strong>Android.mk with GStreamer support</strong></p>
<pre><code>LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := NativeApplication
LOCAL_SRC_FILES := NativeApplication.c
LOCAL_SHARED_LIBRARIES := gstreamer_android
LOCAL_LDLIBS := -landroid

include $(BUILD_SHARED_LIBRARY)

ifndef GSTREAMER_ROOT
ifndef GSTREAMER_ROOT_ANDROID
$(error GSTREAMER_ROOT_ANDROID is not defined!)
endif
GSTREAMER_ROOT            := $(GSTREAMER_ROOT_ANDROID)
endif

GSTREAMER_NDK_BUILD_PATH  := $(GSTREAMER_ROOT)/share/gst-android/ndk-build/
GSTREAMER_PLUGINS         := coreelements ogg theora vorbis videoconvert audioconvert audioresample playback glimagesink soup opensles
G_IO_MODULES              := gnutls
GSTREAMER_EXTRA_DEPS      := gstreamer-video-1.0

include $(GSTREAMER_NDK_BUILD_PATH)/gstreamer.mk
</code></pre>
<p>Where line 7 specifies an extra library to be included in the project:
<code>libgstreamer_android.so</code>. This library contains all GStreamer code,
tailored for your application’s needs, as shown below.</p>
<p>Line 8 specifies additional system libraries, in this case, in order to
access android-specific functionality.</p>
<p>Lines 12 and 13 simply define some convenient macros.</p>
<p>Line 20 lists the plugins you want statically linked into
<code>libgstreamer_android.so</code>. Listing only the ones you need makes your
application smaller.</p>
<p>Line 21 is required to have HTTPS/TLS support from GStreamer, through the
<code>souphttpsrc</code> element.</p>
<p>Line 22 defines which GStreamer libraries your application requires.</p>
<p>Finally, line 24 includes the make files which perform the rest of the
magic.</p>
<p>Listing all desired plugins can be cumbersome, so they have been grouped
into categories, which can be used by including the <code>plugins.mk</code> file,
and used as follows:</p>
<pre><code>include $(GSTREAMER_NDK_BUILD_PATH)/plugins.mk
GSTREAMER_PLUGINS  := $(GSTREAMER_PLUGINS_CORE) $(GSTREAMER_PLUGINS_CODECS) playbin souphttpsrc
</code></pre>
<h4 id="list-of-categories-and-included-plugins">List of categories and included plugins</h4>
<table>
<thead>
<tr>
<th> Category</th>
<th> Included plugins</th>
</tr>
</thead>
<tbody>
<tr>
<td> <code>GSTREAMER_PLUGINS_CORE</code></td>
<td> coreelements adder app audioconvert audiorate audioresample audiotestsrc gio pango typefindfunctions videoconvert videorate videoscale videotestsrc volume autodetect videofilter</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_PLAYBACK</code></td>
<td> playback</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_VIS</code></td>
<td> libvisual goom goom2k1 audiovisualizers</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_EFFECTS</code></td>
<td> alpha alphacolor audiofx cairo cutter debug deinterlace dtmf effectv equalizer gdkpixbuf imagefreeze interleave level multifile replaygain shapewipe smpte spectrum videobox videocrop videomixer accurip aiff audiofxbad autoconvert bayer coloreffects debugutilsbad fieldanalysis freeverb frei0r gaudieffects geometrictransform inter interlace ivtc rawparse removesilence segmentclip smooth speed soundtouch videofiltersbad audiomixer compositor webrtcdsp</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_NET</code></td>
<td> tcp rtsp rtp rtpmanager soup udp dataurisrc sdp srtp rtspclientsink</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_NET_RESTRICTED</code></td>
<td> mms rtmp</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_CODECS</code></td>
<td> subparse ogg theora vorbis opus ivorbisdec alaw apetag audioparsers auparse avi dv flac flv flxdec icydemux id3demux isomp4 jpeg matroska mulaw multipart png speex taglib vpx wavenc wavpack wavparse y4menc adpcmdec adpcmenc dashdemux dvbsuboverlay dvdspu hls id3tag kate midi mxf openh264 opusparse pcapparse pnm rfbsrc schro gstsiren smoothstreaming subenc videoparsersbad y4mdec jpegformat gdp rsvg openjpeg spandsp sbc androidmedia</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_CODECS_GPL</code></td>
<td> assrender</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_CODECS_RESTRICTED</code></td>
<td> asfmux dtsdec faad mpegpsdemux mpegpsmux mpegtsdemux mpegtsmux voaacenc a52dec amrnb amrwbdec asf dvdsub dvdlpcmdec mad mpeg2dec xingmux realmedia x264 lame mpg123 libav</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_SYS</code></td>
<td> opensles opengl</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_CAPTURE</code></td>
<td> camerabin</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_ENCODING</code></td>
<td> encodebin</td>
</tr>
<tr>
<td> <code>GSTREAMER_PLUGINS_GES</code></td>
<td> nle</td>
</tr></tbody></table>
<p>Build and run your application as explained in the <a href="../#building-the-tutorials">Building the tutorials</a> section.</p>

</div>


	</div>
	<div id="search_results">
		<p>The results of the search are</p>
	</div>
</div>
<div class="hidden-xs col-xl-2">
</div>
	</div>
</div>
</main>

<footer class="page-row">
	<div class="container-fluid">
	<div class="row">
		<div class="hidden-xs hidden-sm col-md-3 col-xl-2"></div>
		<div class="col-sm-12 col-md-9 col-xl-8">
						
		</div>
		<div class="hidden-xs col-xl-2"></div>
	</div>
</div>
</footer>

</body>

<script src="assets/js/navbar_offset_scroller.js"></script>
</html>